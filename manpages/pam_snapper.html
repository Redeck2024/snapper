<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>pam_snapper</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.0" />
  </head>
  <body>
    <div class="refentry">
      <a id="pam_snapper8"></a>
      <div class="titlepage"></div>
      <div class="refnamediv">
        <h2>Name</h2>
        <p>pam_snapper â€” PAM module which creates filesystem snapshots via "snapper"</p>
      </div>
      <div class="refsynopsisdiv">
        <a id="synopsis"></a>
        <h2>Synopsis</h2>
        <div class="cmdsynopsis">
          <p><code class="command">pam_snapper.so</code>  [debug] [homeprefix=<em class="replaceable"><code>prefix</code></em>] [ignoreservices=<em class="replaceable"><code>services</code></em>] [ignoreusers=<em class="replaceable"><code>users</code></em>] [rootasroot] [ignoreroot] [openonly] [closeonly] [cleanup=<em class="replaceable"><code>algorithm</code></em>]</p>
        </div>
      </div>
      <div class="refsect1">
        <a id="description"></a>
        <h2>DESCRIPTION</h2>
        <p>Create a snapshot at every login of a user, thus they always have a save
    starting point.</p>
        <p>As many users do not logout for some time, it is a good idea to
    enable snapper's time based snapshots in addition.</p>
      </div>
      <div class="refsect1">
        <a id="options"></a>
        <h2>OPTIONS</h2>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">
                <code class="option">debug</code>
              </span>
            </dt>
            <dd>
              <p>Switch on debugging in the module.</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">homeprefix=<em class="replaceable"><code>prefix</code></em></code>
              </span>
            </dt>
            <dd>
              <p>Prefix for the name of the snapper configuration. The username
	  will be appended to this prefix.</p>
              <p>Default: "home_"</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">ignoreservices=<em class="replaceable"><code>comma separated list of services</code></em></code>
              </span>
            </dt>
            <dd>
              <p>Default: "crond"</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">ignoreusers=<em class="replaceable"><code>comma separated list of users</code></em></code>
              </span>
            </dt>
            <dd>
              <p>Default: (none)</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">rootasroot</code>
              </span>
            </dt>
            <dd>
              <p>Perform a snapshot using the snapper configuration "root" if
	  the user "root" logs in. In other words: the homeprefix is not used
	  in this case. As the snapper configuration "root" is used for the
	  system (the root filesystem), this means that with every login of
	  the user "root" the complete "/" filesystem will be
	  snapshotted. This can be useful to help administrators rolling back
	  in case their activity / configuration changes have been
	  accidentally wrong.</p>
              <p>"rootasroot" and "ignoreroot" are mutually exclusive.</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">ignoreroot</code>
              </span>
            </dt>
            <dd>
              <p>No snapshot is taken, if the user "root" opens/closes a
	  session.</p>
              <p>"rootasroot" and "ignoreroot" are mutually exclusive.</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">openonly</code>
              </span>
            </dt>
            <dd>
              <p>Only create a single snapshot when opening the PAM
	  session.</p>
              <p>Default: create pre- and post-snapshots</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">closeonly</code>
              </span>
            </dt>
            <dd>
              <p>Only create a single snapshot when closing the PAM
	  session.</p>
              <p>Default: create pre- and post-snapshots</p>
            </dd>
            <dt>
              <span class="term">
                <code class="option">cleanup=<em class="replaceable"><code>cleanup-algorithm</code></em></code>
              </span>
            </dt>
            <dd>
              <p>Set snapper cleanup algorithm.</p>
              <p>Default: (none)</p>
            </dd>
          </dl>
        </div>
      </div>
      <div class="refsect1">
        <a id="module_types_provided"></a>
        <h2>MODULE TYPES PROVIDED</h2>
        <p>Only the module type "session" is provided.</p>
      </div>
      <div class="refsect1">
        <a id="return_values"></a>
        <h2>RETURN VALUES</h2>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">PAM_SUCCESS</span>
            </dt>
            <dd>
              <p>pam_snapper will always return PAM_SUCCESS, to not prevent
	  users from login, in case a snapshot fails. This may change in the
	  future.</p>
            </dd>
          </dl>
        </div>
      </div>
      <div class="refsect1">
        <a id="examples"></a>
        <h2>EXAMPLES</h2>
        <div class="refsect2">
          <a id="basic_usage"></a>
          <h3>Basic usage</h3>
          <div class="orderedlist">
            <ol class="orderedlist" type="1">
              <li class="listitem">
                <p>Create a btrfs subvolume for the new user and a snapper
	  configuration, e.g. using the tool
	  <code class="filename">/usr/lib/pam_snapper/pam_snapper_useradd.sh</code>.</p>
              </li>
              <li class="listitem">
                <p>Add the following line to
	  <code class="filename">/etc/pam.d/common-session</code>:
	  </p>
                <pre class="programlisting">
session    optional    pam_snapper.so
	  </pre>
                <p>
	  </p>
              </li>
            </ol>
          </div>
        </div>
      </div>
      <div class="refsect1">
        <a id="see_also"></a>
        <h2>SEE ALSO</h2>
        <p>
      <a class="citerefentry" href="snapper.html"><span class="citerefentry"><span class="refentrytitle">snapper</span>(8)</span></a>,
      <span class="citerefentry"><span class="refentrytitle">pam.conf</span>(5)</span>,
      <span class="citerefentry"><span class="refentrytitle">pam</span>(8)</span>,
      pam_snapper_homeconvert,
      pam_snapper_pamconfig,
      pam_snapper_useradd,
      pam_snapper_userdel
    </p>
      </div>
      <div class="refsect1">
        <a id="homepage"></a>
        <h2>HOMEPAGE</h2>
        <p>
          <a class="ulink" href="http://snapper.io/" target="_top">http://snapper.io/</a>
        </p>
      </div>
      <div class="refsect1">
        <a id="authors"></a>
        <h2>AUTHORS</h2>
        <p>pam-snapper was written by Matthias G. Eckermann <code class="email">&lt;<a class="email" href="mailto:mge@suse.com">mge@suse.com</a>&gt;</code>
    as part of SUSE Hackweek#9 in April 2013.</p>
        <p>This module would not have been possible without the work of Arvin
    Schnell on the snapper project. pam-snapper inherits DBUS handling from
    "snapper_dbus_cli.c" by David Disseldorp.</p>
        <p>The module builds on the Linux PAM stack and its documentation,
    written by Thorsten Kukuk.</p>
      </div>
      <div class="refsect1">
        <a id="license"></a>
        <h2>LICENSE</h2>
        <p>Copyright (c) 2013 SUSE</p>
        <p>All Rights Reserved.</p>
        <p>This program is free software; you can redistribute it and/or modify
    it under the terms of version 2 of the GNU General Public License as published
    by the Free Software Foundation.</p>
        <p>This program is distributed in the hope that it will be useful, but
    WITHOUT ANY WARRANTY without even the implied warranty of MERCHANTABILITY or
    FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
    details.</p>
        <p>You should have received a copy of the GNU General Public License
    along with this program; if not, contact SUSE.</p>
        <p>To contact SUSE about this file by physical or electronic mail, you
    may find current contact information at www.suse.com.</p>
      </div>
    </div>
  </body>
</html>
